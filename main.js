const translations = {
    pt: {
        role: "Gestão Comercial e Projetos Digitais",
        section_summary: "Resumo",
        summary_text: "Profissional de Gestão Comercial e Projetos Digitais com vivência em vendas consultivas e liderança de equipes. Atualmente desenvolvo projetos autônomos e busco recolocação no mercado para somar resultados com minha expertise em negociação e criação de materiais estratégicos de venda.",
        section_experience: "Experiencia Profissional",
        job1_title: "Analista de Vendas e Processos",
        job1_desc1: "<strong>Vendas Consultivas:</strong> Gestão do ciclo de vendas consultivas de ativos imobiliários de alto valor.",
        job1_desc2: "<strong>Processos:</strong> Implementação de análise de dados para qualificação de leads e otimização do funil de vendas.",
        job2_title: "Presidente e Fundador",
        job2_desc1: "<strong>Gestão de Equipe:</strong> Liderança executiva de equipe multidisciplinar (30 membros). Definição de metas estratégicas e rotinas operacionais.",
        job2_desc2: "<strong>Financeiro:</strong> Reestruturação financeira completa e captação estratégica de recursos, garantindo superávit operacional para a gestão seguinte.",
        job3_title: "Produtor Digital e Gestor de Projetos",
        job3_company: "Autônomo",
        job3_desc1: "<strong>Projetos Web:</strong> Gestão e execução de projetos digitais end-to-end. Desenvolvimento de interfaces web focadas em performance e conversão.",
        job3_desc2: "<strong>Mídia e Design:</strong> Produção audiovisual para eventos corporativos, incluindo cobertura e edição ágil (ex: Fórum Ambição 2030).",
        job3_desc3: "<strong>Ferramentas:</strong> Criação de ferramentas de automação de processos para otimização de cálculos e rotinas.",
        job4_title: "Assistente de Importação",
        job4_desc1: "<strong>Comércio Exterior:</strong> Operacionalização de processos de importação/exportação e gestão de relacionamento com cadeia de suprimentos internacional.",
        section_skills: "Habilidades Técnicas",
        skill_cat1: "Design e Audiovisual",
        skill_cat2: "Negócios e Ferramentas",
        section_education: "Formação Acadêmica",
        edu1_title: "Relações Internacionais (Bacharelado)",
        edu2_title: "Técnico em Administração",
        section_languages: "Idiomas",
        lang1_name: "Português",
        lang1_details: "Nativo",
        lang2_name: "Inglês",
        lang2_details: "Fluente (Vivência Internacional & Comércio Exterior)",
        lang3_name: "Espanhol",
        lang3_details: "Profissional (Foco em leitura e compreensão corporativa)",
        lang4_name: "Africâner",
        lang4_details: "Básico (Noções gerais)",
        section_activities: "Atividades Extracurriculares",
        act1_desc: "Gestão estratégica de Imagem Pública e comunicação corporativa para o Interact e Rotaract Club.",
        act2_title: "Intercâmbio (Rotary Youth Exchange)",
        act2_desc: "África do Sul."
    },
    en: {
        role: "Commercial Management & Digital Projects",
        section_summary: "Summary",
        summary_text: "Professional with experience in Commercial Management and Digital Projects, including consultative sales and team leadership. Currently working as a freelancer, I am actively seeking new opportunities in the corporate market to leverage my skills in sales strategy and digital content creation.",
        section_experience: "Professional Experience",
        job1_title: "Sales and Process Analyst",
        job1_desc1: "<strong>Consultative Sales:</strong> Management of consultative sales cycles for high-value real estate assets.",
        job1_desc2: "<strong>Processes:</strong> Implementation of data analysis for lead qualification and sales funnel optimization.",
        job2_title: "President and Founder",
        job2_desc1: "<strong>Team Management:</strong> Executive leadership of a multidisciplinary team (30 members). Definition of strategic goals and operational routines.",
        job2_desc2: "<strong>Financial:</strong> Complete financial restructuring and strategic fundraising, ensuring operational surplus for the next management.",
        job3_title: "Digital Producer and Project Manager",
        job3_company: "Freelance",
        job3_desc1: "<strong>Web Projects:</strong> Management and execution of end-to-end digital projects. Development of performance-focused web interfaces.",
        job3_desc2: "<strong>Media & Design:</strong> Audiovisual production for corporate events, including coverage and agile editing (e.g., Ambition 2030 Forum).",
        job3_desc3: "<strong>Tools:</strong> Creation of process automation tools for calculation and routine optimization.",
        job4_title: "Import Assistant",
        job4_desc1: "<strong>Foreign Trade:</strong> Operationalization of import/export processes and relationship management with the international supply chain.",
        section_skills: "Technical Skills",
        skill_cat1: "Design & Audiovisual",
        skill_cat2: "Business & Tools",
        section_education: "Education",
        edu1_title: "International Relations (Bachelor's)",
        edu2_title: "Business Administration Technician",
        section_languages: "Languages",
        lang1_name: "Portuguese",
        lang1_details: "Native",
        lang2_name: "English",
        lang2_details: "Fluent (International Experience & Foreign Trade)",
        lang3_name: "Spanish",
        lang3_details: "Professional (Focus on corporate reading and comprehension)",
        lang4_name: "Afrikaans",
        lang4_details: "Basic (General notions)",
        section_activities: "Extracurricular Activities",
        act1_desc: "Strategic management of Public Image and corporate communication for Interact and Rotaract Club.",
        act2_title: "Exchange Program (Rotary Youth Exchange)",
        act2_desc: "South Africa."
    },
    es: {
        role: "Gestión Comercial y Proyectos Digitales",
        section_summary: "Resumen",
        summary_text: "Profesional con experiencia en Gestión Comercial y Proyectos Digitales, incluyendo ventas consultivas y liderazgo de equipos. Actualmente trabajo como autónomo, pero busco activamente nuevas oportunidades en el mercado corporativo para aplicar mis habilidades en estrategia comercial y creación de contenido digital.",
        section_experience: "Experiencia Profesional",
        job1_title: "Analista de Ventas y Procesos",
        job1_desc1: "<strong>Ventas Consultivas:</strong> Gestão del ciclo de ventas consultivas de ativos imobiliarios de alto valor.",
        job1_desc2: "<strong>Procesos:</strong> Implementación de análisis de datos para calificación de leads y optimización del embudo de ventas.",
        job2_title: "Presidente y Fundador",
        job2_desc1: "<strong>Gestión de Equipo:</strong> Liderazgo ejecutivo de equipo multidisciplinario (30 miembros). Definición de metas estratégicas y rutinas operativas.",
        job2_desc2: "<strong>Financiero:</strong> Reestructuración financiera completa y captación estratégica de recursos, garantizando superávit operativo para la gestión siguiente.",
        job3_title: "Productor Digital y Gestor de Proyectos",
        job3_company: "Autónomo",
        job3_desc1: "<strong>Proyectos Web:</strong> Gestión y ejecución de proyectos digitales end-to-end. Desarrollo de interfaces web enfocadas en rendimiento y conversión.",
        job3_desc2: "<strong>Medios y Diseño:</strong> Producción audiovisual para eventos corporativos, incluyendo cobertura y edición ágil (ej: Foro Ambición 2030).",
        job3_desc3: "<strong>Herramientas:</strong> Creación de herramientas de automatización de procesos para optimización de cálculos y rutinas.",
        job4_title: "Asistente de Importación",
        job4_desc1: "<strong>Comercio Exterior:</strong> Operacionalización de procesos de importación/exportación y gestión de relaciones con la cadena de suministro internacional.",
        section_skills: "Habilidades Técnicas",
        skill_cat1: "Diseño y Audiovisual",
        skill_cat2: "Negocios y Herramientas",
        section_education: "Formación Académica",
        edu1_title: "Relaciones Internacionales (Licenciatura)",
        edu2_title: "Técnico en Administración",
        section_languages: "Idiomas",
        lang1_name: "Portugués",
        lang1_details: "Nativo",
        lang2_name: "Inglés",
        lang2_details: "Fluido (Vivencia Internacional y Comercio Exterior)",
        lang3_name: "Español",
        lang3_details: "Profesional (Enfoque en lectura y comprensión corporativa)",
        lang4_name: "Afrikáans",
        lang4_details: "Básico (Nociones generales)",
        section_activities: "Actividades Extracurriculares",
        act1_desc: "Gestión estratégica de Imagen Pública y comunicación corporativa para Interact y Rotaract Club.",
        act2_title: "Intercambio (Rotary Youth Exchange)",
        act2_desc: "Sudáfrica."
    }
};

function setLanguage(lang) {
    document.documentElement.lang = lang;

    // Update buttons
    document.querySelectorAll('.lang-btn').forEach(btn => {
        const isActive = btn.textContent.toLowerCase() === lang;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-pressed', isActive ? 'true' : 'false');
    });

    // Update text
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang][key]) {
            element.innerHTML = translations[lang][key];
        }
    });
}

// Theme Toggle Logic
document.addEventListener('DOMContentLoaded', () => {
    const themeToggleBtn = document.getElementById('theme-toggle');
    const htmlElement = document.documentElement;

    // Check for saved user preference
    const currentTheme = localStorage.getItem('theme');
    if (currentTheme === 'dark') {
        htmlElement.classList.add('dark');
    }

    // Initialize theme button aria state
    if (themeToggleBtn) {
        themeToggleBtn.setAttribute('aria-pressed', htmlElement.classList.contains('dark') ? 'true' : 'false');
        
        themeToggleBtn.addEventListener('click', () => {
            htmlElement.classList.toggle('dark');
            const isDark = htmlElement.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeToggleBtn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
        });
    }

    // Ensure language buttons have correct aria-pressed on load
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.setAttribute('aria-pressed', btn.classList.contains('active') ? 'true' : 'false');
    });

    // Initialize Sidebar Logic
    generateOutline();
    setupScrollSpy();
});

// View Switching Logic
function switchView(viewName) {
    const resumeView = document.getElementById('resume-view');
    const playgroundView = document.getElementById('playground-view');
    const outlineSection = document.getElementById('outline-section');
    
    // Update Sidebar Buttons
    document.querySelectorAll('.sidebar-item').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent.trim().toLowerCase().includes(viewName)) {
            btn.classList.add('active');
        }
    });

    if (viewName === 'resume') {
        resumeView.style.display = 'block';
        playgroundView.style.display = 'none';
        outlineSection.style.display = 'block';
        // Re-run scroll spy setup as elements might have shifted
        setTimeout(setupScrollSpy, 100);
        
        // Stop any running experiment when leaving playground
        if (Experiments) Experiments.stopCurrent();
        
    } else {
        resumeView.style.display = 'none';
        playgroundView.style.display = 'block';
        outlineSection.style.display = 'none';
    }
}

// Experiment Logic
function openExperiment(type) {
    const dashboard = document.getElementById('playground-dashboard');
    const container = document.getElementById('experiment-container');
    const views = document.querySelectorAll('.experiment-view');
    
    // Hide dashboard, show container
    dashboard.style.display = 'none';
    container.style.display = 'block';
    
    // Hide all views first
    views.forEach(v => v.style.display = 'none');
    
    // Show specific view
    const view = document.getElementById(`${type}-view`);
    if (view) {
        view.style.display = 'block';
        // Initialize experiment
        if (Experiments && Experiments[type]) {
            // Stop any previous
            Experiments.stopCurrent();
            // Start new
            Experiments.cleanup = Experiments[type](`${type}Canvas`);
            Experiments.activeId = type;
        }
    }
}

function closeExperiment() {
    const dashboard = document.getElementById('playground-dashboard');
    const container = document.getElementById('experiment-container');
    
    // Stop experiment
    if (Experiments) {
        Experiments.stopCurrent();
    }
    
    container.style.display = 'none';
    dashboard.style.display = 'block';
}

// Make functions global for HTML access
window.openExperiment = openExperiment;
window.closeExperiment = closeExperiment;
window.switchView = switchView;
window.setLanguage = setLanguage;

// Outline Generation Logic
function generateOutline() {
    const outlineList = document.querySelector('.outline-list');
    const sections = document.querySelectorAll('#resume-view h2');
    
    outlineList.innerHTML = ''; // Clear existing

    sections.forEach((section, index) => {
        // Ensure section has an ID for linking
        if (!section.id) {
            section.id = `section-${index}`;
        }

        const link = document.createElement('a');
        link.className = 'outline-item';
        link.textContent = section.textContent;
        link.href = `#${section.id}`;
        
        link.addEventListener('click', (e) => {
            e.preventDefault();
            section.scrollIntoView({ behavior: 'smooth' });
        });

        outlineList.appendChild(link);
    });
}

// Scroll Spy Logic (Highlight active section in outline)
function setupScrollSpy() {
    const sections = document.querySelectorAll('#resume-view h2');
    const outlineItems = document.querySelectorAll('.outline-item');

    const observerOptions = {
        root: null,
        rootMargin: '-10% 0px -80% 0px', // Trigger when section is near top
        threshold: 0
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // Remove active class from all
                outlineItems.forEach(item => item.classList.remove('active'));
                
                // Add active class to corresponding link
                const id = entry.target.id;
                const activeLink = document.querySelector(`.outline-item[href="#${id}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }
        });
    }, observerOptions);

    sections.forEach(section => observer.observe(section));
}
